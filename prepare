--- Order
SELECT
  order_id,
  COUNT(DISTINCT product_id) AS product_count,
  COUNT(*) AS row_count
FROM `bigquery-public-data.thelook_ecommerce.order_items`
GROUP BY order_id
ORDER BY product_count DESC
LIMIT 20;

SELECT
 order_id, 
 user_id,
 product_id, 
 sale_price
FROM bigquery-public-data.thelook_ecommerce.order_items
WHERE 
  order_id IN(
    SELECT order_id
    FROM bigquery-public-data.thelook_ecommerce.order_items
    GROUP BY order_id
    HAVING COUNT(DISTINCT product_id) >1
  )
ORDER BY order_id
LIMIT 50;

SELECT 
  order_id,
  product_id,
  COUNT(*) AS item_count,
  SUM(sale_price) AS total_price
FROM bigquery-public-data.thelook_ecommerce.order_items
GROUP BY order_id, product_id
ORDER BY item_count DESC;
